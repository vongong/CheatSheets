agentless architecture
  SSH enabled
  Python needs to be installed on linux server.
    ls /usr/bin/python3
  Powershell needs to be installed on windows server.

Ansible Tower
  UI Dashboard
  Centrally store automated Tasks
  config Permissions
  get health status

Other Tools
  puppet & chef
    use ruby - more difficult to learn
    need to install agent & manage updates

Install
  Locally or Remote Server
  Ansible is written in Python. Need Python to run
  can install via PIP (python package manager)

Inventory
  Static
    Could in text file. INI-style or Yaml 
    manually updated
  dynamic
    autogenerated
  location: ansible --version
    default: /etc/ansible/hosts
  ini-format
    list of hosts or IP address
    organized by groups
    host can be in multiple groups
  example
    134.122.92.122 ansible_ssh_private_key_file=~/.ssh/id_rsa ansible_user=root
    ssh -i ~/.ssh/id_rsa root@134.122.92.122
  Group pre-defined
    all - every host
    ungrouped - hosts in all, not in another group
  group naming
    avoid dashes, underscore fine
    don't name group same as host
    can be nested. groups of group use xxx:children suffix
    ranges pattern matching [Start:End] - numbers or letters
      192.168.[4:7].[0:256]
      server[01:20].example.com
      [a:c].dns.example.com
  Yaml format
  ansible-Inventory -i inventory --list
  ansible-Inventory -y --list
  ansible hostname --list-hosts

config file
  check ansible_config env variable
  then ck ./ansible.cfg
  then ck ~/ansible.cfg
  several sections - key value pair
    [default]
      ssh connections
      remote_user, remote_port, ask_pass
    [privilege_escalation]
      become key - bool
      become_user ie root
      become_method - sudo 
      become_ask_pass - no/yes
  ansible-config dump --only-changed

ansible modules
  idempotent - only apply change if needed. It checks to see if in desired state.

adhoc commands
  use ansible commands
    host-pattern 
    -m modules
    -a all arguements
    ie. ansible all -m ping
  override default
    -k or --ask-pass will prompt password
    -u override remote_user
    -b privilege_escalation
    -K prompt password for escalation
    --become-method

playbook
  yaml must start with ---
  ansible-playbook filename.yml
    --limit: limits hosts or host pattern
    --syntax-check: verify that it can ingested
    -C: DryRun
  variables
    rules
      starts with letter
      allow: letters, numbers, underscore
      Space, Periods, and Dashes not allowed
    scope
      global: all
      host: set for host or groups
      play: for current play. def in vars or include_vars task
    precendence:
      level with highest precendence wins
      narrow over wide
      override with -e option
    vars block
      vars:
        user_name: jane
        user_state: present
    vars file
      vars_files:
        - vars/users.yaml
    Reference with double braces: {{ user_name }}
    may need to use double quote: "{{ user_name }}"

Secure Sensitive data with Ansible Vault
  ansible-vault create filename
  ansible-vault view filename
  ansible-vault edit filename
  ansible-vault encrypt filename #encrypt existing file
  ansible-vault encrypt filename --output=new_filename #encrypt as new file
  ansible-vault decrypt filename
  --vault-id password for vault when calling from playbook
  @promtp = prompt for value
  ansible-vault rekey filename #change password for file
  suppress output
    task: no_log: true

iteration
  Loop Variable item hold values of each iteration
  May need to use double quote: "{{ item }}"
  Task Keyword: Loop
    vars:
      myusers:
        - aditay
        - boris
        - carl
    loop: {{ myusers }}
    or
    loop:
      - flintstone
      - rubble
  Loop dictionary: with_dict
    with_dict:
    - { name: 'fred', group: 'flintstone'}
    - { name: 'barney', group: 'rubbles'}

Conditional

trigger